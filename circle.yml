experimental:
  picard:
    executorType: machine
    machineInfo:
      digitalocean:
        image: "20250992"
        region: nyc3
        access-token: 3138a9b186d9f1063d0877a4c14ef3b7f7c476ceb744ebba0c8b1a4aa717dbe0
    stages:
      build:
        workDir: /tmp/picard-dummy
        steps:
          - type: checkout
          - type: shell
            name: install docker-compose
            command: |
              set -ex
              curl -L https://github.com/docker/compose/releases/download/1.8.0/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose
              chmod +x /usr/local/bin/docker-compose
              docker-compose --version
              docker info
          - type: shell
            name: spin up docker containers
            command: |
              set -ex
              docker-compose up -d
          - type: shell
            name: test that docker is up
            command: |
              set -ex
              sleep 4
              docker exec dockercomposehelloworld_web_1 curl --retry 10 http://localhost:8080/
